# Smithery configuration file: https://smithery.ai/docs/build/project-config

startCommand:
  type: stdio
  configSchema:
    # JSON Schema defining the configuration options for the MCP.
    type: object
    required:
      - supabaseUrl
      - supabaseAnonKey
    properties:
      supabaseUrl:
        type: string
        description: Self-hosted Supabase HTTP URL
      supabaseAnonKey:
        type: string
        description: Supabase anonymous key
      supabaseServiceRoleKey:
        type: string
        description: Supabase service role key (optional)
      databaseUrl:
        type: string
        description: Direct PostgreSQL connection string (optional)
      supabaseAuthJwtSecret:
        type: string
        description: Supabase JWT secret (optional)
      securityProfile:
        type: string
        enum:
          - readonly
          - standard
          - admin
          - custom
        description: Security profile controlling which tools are enabled (default: admin)
      toolsConfig:
        type: string
        description: Path to tools config JSON (required when securityProfile is custom)
      userEmail:
        type: string
        description: Override auto-managed user account with specific email (optional)
      userPassword:
        type: string
        description: Password for the user account (required if userEmail is set)
  commandFunction:
    # A JS function that produces the CLI command based on the given config to start the MCP on stdio.
    |-
    (config) => {
      const args = [
        'dist/index.js',
        '--url', config.supabaseUrl,
        '--anon-key', config.supabaseAnonKey
      ];
      if (config.supabaseServiceRoleKey) {
        args.push('--service-key', config.supabaseServiceRoleKey);
      }
      if (config.databaseUrl) {
        args.push('--db-url', config.databaseUrl);
      }
      if (config.supabaseAuthJwtSecret) {
        args.push('--jwt-secret', config.supabaseAuthJwtSecret);
      }
      if (config.toolsConfig) {
        args.push('--tools-config', config.toolsConfig);
      }
      if (config.securityProfile) {
        args.push('--security-profile', config.securityProfile);
      }
      if (config.userEmail) {
        args.push('--user-email', config.userEmail);
      }
      if (config.userPassword) {
        args.push('--user-password', config.userPassword);
      }
      return { command: 'node', args };
    }
  exampleConfig:
    supabaseUrl: http://localhost:8000
    supabaseAnonKey: example-anon-key
    supabaseServiceRoleKey: example-service-key
    databaseUrl: postgresql://postgres:password@localhost:5432/postgres
    supabaseAuthJwtSecret: example-jwt-secret
    securityProfile: admin
    # userEmail and userPassword are optional - if not set, server auto-manages a user account
    # userEmail: my-user@example.com
    # userPassword: my-password
